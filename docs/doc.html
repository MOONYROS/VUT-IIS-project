<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="cs">
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-2"/>
    <title>Projekt IIS</title>
    <style type="text/css">
    	table { border-collapse: collapse; }
    	td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
    	dt { font-weight: bold; margin-top: 0.5em; }
		body {
			width: 70%;
			margin: auto;
		}
    </style>
</head>
<body>

<h1>Plánování rozvrhù</h1>
<dl>
	<dt>Autoøi</dt>

	<dd>Joná¹ Morkus
	    <a href="mailto:xmorku03@stud.fit.vutbr.cz">xmorku03@stud.fit.vutbr.cz</a> -
		modelování databáze, implementace views, controllers, services, video.
	</dd>

	<dd>Ondøej Luká¹ek
	    <a href="mailto:xlukas15@stud.fit.vutbr.cz">xlukas15@stud.fit.vutbr.cz</a> -
		implementace views, controllers, services, stylování, dokumentace.
	</dd>

	<dd>Ondøej Koumar
	    <a href="mailto:xkouma02@stud.fit.vutbr.cz">xkouma02@stud.fit.vutbr.cz</a> -
		implementace views, controllers, services, Doxygen komentáøe, kolize rozvrhu.
	</dd>

	<dt>URL aplikace</dt>

	<dd>
		<a href="http://www.stud.fit.vutbr.cz/~xlukas15/">http://www.stud.fit.vutbr.cz/~xlukas15/</a>
	</dd>
</dl>

<h2>U¾ivatelé systému pro testování</h2>
<table>
	<tr>
		<th>Email</th>
		<th>Heslo</th>
		<th>Role</th>
	</tr>
	<tr>
		<td>admin@admin.admin</td>
		<td>admin</td>
		<td>Administrátor</td>
	</tr>
	<tr>
		<td>ucitel@ucitel.uc</td>
		<td>vyucujici</td>
		<td>Vyuèující (garant nìjakého pøedmìtu)</td>
	</tr>
	<tr>
		<td>vyuc@vyuc.vyuc</td>
		<td>vyucujici</td>
		<td>Vyuèující (negarantuje ¾ádný pøedmìt)</td>
	</tr>
	<tr>
		<td>rozv@rozv.rozv</td>
		<td>rozvrhar</td>
		<td>Rozvrháø</td>
	</tr>
	<tr>
		<td>stud@stud.stud</td>
		<td>student</td>
		<td>Student</td>
	</tr>
	<tr>
		<td>-</td>
		<td>-</td>
		<td>Neregistrovaný u¾ivatel ("Vstoupit bez pøihlá¹ení" na login stránce)</td>
	</tr>
</table>

<h3>Video</h3>
<p>
	<a href="https://vutbr-my.sharepoint.com/:v:/g/personal/xmorku03_vutbr_cz/ETpLcjTg8AJElAXixU67QP0BhePgdCRaUbnNRd3frzAEhQ?nav=eyJyZWZlcnJhbEluZm8iOnsicmVmZXJyYWxBcHAiOiJPbmVEcml2ZUZvckJ1c2luZXNzIiwicmVmZXJyYWxBcHBQbGF0Zm9ybSI6IldlYiIsInJlZmVycmFsTW9kZSI6InZpZXciLCJyZWZlcnJhbFZpZXciOiJNeUZpbGVzTGlua0RpcmVjdCJ9fQ&e=jjpjcl">Odkaz na video na Sharepointu</a>
</p>

<h2>Implementace</h2>
<p>
	Projekt jsme se sna¾ili rozdìlit do 3 vrstev:
</p>

<ul>
	<li>Views - Vizuální stránka informaèního systému, vykresluje data z Controllers a do nich posílá data z formuláøù</li>
	<li>Controllers - pøedávají data mezi Services a Views</li>
	<li>Services - pokládají dotazy a úkoly databázi</li>
</ul>

<p>
	Projekt je vypracován bez vyu¾ití frameworkù (typu Laravel, Symfony, apod.).
	Na komunikaci s databází bylo vyu¾ito PDO.
	Pro frontend bylo vyu¾ito jazyka CSS, opìt bez ¾ádných frameworkù (typu Bootstrap), ale byl psán ruènì.
</p>
<p>
	Jednotlivé pøípady u¾ití jsou organizovány podle slo¾ek.
	To znamená, ¾e napøíklad o správu místností se stará pro views slo¾ka <i>views/room_views</i>,
	pro services skript <i>services/room_service.php</i>,
	a nakonec pro controllers slo¾ka <i>controllers/room_controllers</i>.
	Velmi obdobnì je tomu tak i se správou osob, pøedmìtù a výukových aktivit.
</p>
<p>
	Trochu jinak v¹ak funguje systém pro zobrazování rozvrhù, jejich øazení, systém zobrazování ¾ádostí, a podobnì.
	Tyto funkcionality jsou toti¾ èasto vyu¾ívané ve spojitosti s vícero tabulkami nebo spojovacími tabulkami.
	Z tìch se dále vyèítá více údajù z jiných tabulek prostøednictvím cizích klíèù (v diagramu oznaèeny &lt;&lt;FK&gt;&gt;),
	které v¾dy smìøuji na primární klíèe jiných tabulek (oznaèeny &lt;&lt;PK&gt;&gt;) a
	díky tomu jednoznaènì identifikují daný øadek odkazované tabulky.
</p>
<p>
	Mezi nejpodstatnìj¹í funkce se øadí <i>loadActivity($ID)</i> nebo funkce ve scriptu <i>schedule_controller.php</i>.
	Bez nich by nebylo mo¾né poøádnì zobrazit rozvrh nebo s ním manipulovat (filtrovat si jednotlivé dny, apod.).
</p>
<p>
	Dal¹í dùle¾itou souèástí jsou scripty pro manipulaci s osobami (mazání, vytváøení, úprava, naèítání seznamu u¾ivatelù).
</p>
<p>
	V¹echna potøebná pole ve formuláøích jsou zasílána pøevá¾nì metodou <b>post</b>.
	Je to z dùvodu, ¾e pøi posílání velkého mno¾ství informací by URL adresa vypadala velmi nevzhlednì.
	Metodou <b>get</b> si posíláme napøíklad jednorázové zprávy nebo pøíznaky nìjaké akce (chybové kódy, krátká ID).
	Vyplnìní jednotlivých políèek formuláøù je kontrolováno za pomocí Javascriptu (<i>/public/validateForm.js</i>).
	V nìm jsou nastavena povinná pole formuláøe.
	Pøi odeslání formuláøe se funkce spustí a zkontroluje vyplnìní v¹ech povinných polí.
	Nevyplnìná povinná pole jsou následnì ohranièena èerveným rámeèkem, aby bylo jasnì vidìt,
	která políèka je¹tì musí u¾ivatel vyplnit.
</p>

<h3>Databáze</h3>
<p>
	Databázi si je mo¾né prohlédnout v SQL kódu ve slo¾ce <i>misc/database.sql</i>.
	Souèástí kódu této databáze jsou pøíkazy pro vlo¾ení samplových dat.
</p>
<p>
	<img src="IIS_diagram_160ppi.png" alt="Diagram databáze">
</p>

<h2>Instalace</h2>
<h3>Softwarové po¾adavky</h3>
<p>
	Celý informaèní systém je otestován na serveru EVA (eva.fit.vutbr.cz).
	V praxi byl informaèní systém vyvíjen v Docker containerech (MySQL Server a Apache).
	Informaèní systém je tedy funkèní a otestovaný na následujícím softwaru.
</p>

<ul>
	<li>
		Apache webový server
		<ul>
			<li>PHP 8.2 (Docker)</li>
			<li>PHP 8.1.25 (EVA)</li>
		</ul>
	</li>
	<li>
		MySQL databázový server
		<ul>
			<li>Verze 8.2.0 (Docker)</li>
			<li>Verze 5.7.42 (EVA)</li>
		</ul>
	</li>
</ul>

<h3>Postup instalace na server</h3>
<p>
	Jako první je potøeba si zaøídit a nainstalovat webový a databázový server (jejich specifikace jsou vý¹e).
	Do koøenového adresáøe Va¹eho webového serveru je následnì potøeba umístit obsah archivu, odevzdaného týmem xmorku03.
	Pro ovìøení, ¾e jste jej umístili na správné místo si mù¾ete zobrazit ve Va¹em webovém prohlí¾eèi URL va¹eho webového serveru.
	Pokud se Vám zobrazí pøihla¹ovací stránka (bez jakékoliv stylizace), jsou zdrojové soubory umístìny správnì.
</p>
<p>
	Nyní je je¹tì potøeba nastavit správnì cestu ke CSS stylovému souboru a k Javascipt skriptu pro kontrolu vyplnìnosti formuláøù.
	Pro její nastavení prosím bì¾te do souboru <i>common.php</i> do funkce <i>make_header()</i>.
	Zde je potøeba nastavit hodnotu promìnné <i>$domain</i> na URL va¹eho webového serveru místo aktuálního <i>'http://localhost:8080'</i>.
	Je to z dùvodu, ¾e soubory je potøeba mít dostupné z mnoha kontextù informaèního systému a na serveru EVA,
	není koøenový adresáø webového serveru nastaven na adresáø studenta.
</p>
<p>
	Po nastavení hodnoty promìnné je dobré si vyzkou¹et, zdali byla nastavená správnì.
	Pokud se Vám pøi otevøení URL webového serveru ve va¹em prohlí¾eèi nezobrazí pøihla¹ovací stránka, obsahující stylování,
	potom mù¾e být je¹tì chyba v cache va¹e prohlí¾eèe, který si va¹i stránku ulo¾il.
	Pokuste se vyèistit cache va¹eho prohlí¾eèe pro URL webového serveru a URL serveru znova otevøete.
</p>
<p>
	Pokud se ani nyní nevykresluje stylizovaná pøihla¹ovací stránka, je chyba v nastavení promìnné <i>$domain</i>.
	Zkuste ji znovu nastavit a zopakovat pøedchozí postup.
	Pøi správném nastavení promìnné se styl naète.
</p>

<h3>Nastavení databáze</h3>
<p>
	Pokud jste si vyzkou¹eli pøihlá¹ení nebo jenom vstoupit bez pøihlá¹ení, v¹imli jste si, ¾e vás systém nepøihlásil nebo nevypsal anotace pøedmìtù.
	To je z dùvodu nenastaveného databázového serveru. Proto bude potøeba následující:
</p>

<ul>
	<li>Nastavení PDO pøipojení</li>
	<li>Spu¹tìní SQL skriptu (nahrání tabulek a sample dat)</li>
</ul>

<p>
	Nyní je potøeba si zjistit <b>adresu databázového serveru</b>, <b>jméno u¾ivatele databázového serveru</b> a <b>heslo u¾ivatele databázového serveru</b>.
</p>
<p>
	Pokud máte v¹echny tyto údaje, otevøete si soubor <i>db_conn_parameters.php</i> ve slo¾ce <i>misc</i>.
	Zde doplòte va¹e zji¹tìné údaje do promìnných <i>$connString</i>, <i>$userName</i>, <i>$password</i>.
	Údaje doplòte tak aby:
</p>

<ul>
	<li>
		promìnná <i>$connString</i> obsahovala adresu databázového serveru,
	</li>
	<li>
		promìnná <i>$userName</i> obsahovala jméno u¾ivatele databázového serveru,
	</li>
	<li>
		promìnná <i>$password</i> obsahovala heslo u¾ivatele databázového serveru.
	</li>
</ul>

<p>
	Nyní je nastaveno PDO pøipojení k databázi a je potøeba pouze naplnit Va¹i databázi tabulkami a ukázkovými daty.
	Pro to doporuèujeme se pøipojit k va¹í databázi nìjakého nástroje. Námi testované nástroje jsou napøíklad
	<a href="https://www.jetbrains.com/datagrip/">JetBrains Datagrip</a>,
	<a href="https://www.mysql.com/products/workbench/">MySQL Workbench</a> nebo webový klient (pokud jej máte nastavený)
	<a href="https://www.phpmyadmin.net/">phpMyAdmin</a>.
</p>
<p>
	Nyní si okopírujte obsah souboru <i>database.sql</i> ze slo¾ky <i>misc</i> do va¹eho zvoleného klienta a skript spus»te.
	Pokud skript probìhl bez potí¾í, je v¹e zaøízeno a mù¾ete se pøihlásit a zaèít pou¾ívat informaèní systém.
</p>
<p>
	Pokud se pøi spu¹tìní skriptu vyskytly komplikace, je mo¾né, ¾e u¾íváte nekompatibilní verzi MySQL nebo máte
	¹patnì nastavený nástroj pro spou¹tìní skriptu.
	Ovìøte si správnost va¹eho nastavení a verzi SQL a opakujte postup.
</p>
<p>
	Pokud skript probìhl bez potí¾í, ale nevidíte stále ¾ádná data a nemù¾ete se pøihlásit, je zøejmì ¹patné nastavení PDO pøipojení.
	Zkuste si ovìøit správnost Va¹ich zadaných dat a postup znovu opakujte.
</p>
<p>
	Nyní by mìl být informaèní systém kompletnì funkèní.
</p>

<h2>Známé problémy</h2>
<p>
	Systém implementuje v¹echny body zadání, ale nicménì se najdou drobnosti, které lehce kazí pou¾itelnost.
	Napøíklad filtrování osob podle jejich role nebo filtrování místností podle jejich atributù, a podobnì.
</p>

</body>
</html>
